<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Part 0: Logging and visualising ambient data with a Raspberry Pico W | John Heaven</title><meta name=keywords content><meta name=description content="The Raspberry Pico W is a cheap microcontroller (around €8) that can control sensors and access a WIFI network. With a bit of soldering and MicroPython, you can have it serving JSON data over your local network, then log it with a database and visualise it in a dashboard. Here I&rsquo;m just going to briefly describe my setup as the basis for later blog articles.
Overall setup Architecture diagram
Full-size image"><meta name=author content="John Heaven"><link rel=canonical href=/post/logging-ambient-data-raspberry-pico-grafana-pi/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Part 0: Logging and visualising ambient data with a Raspberry Pico W"><meta property="og:description" content="The Raspberry Pico W is a cheap microcontroller (around €8) that can control sensors and access a WIFI network. With a bit of soldering and MicroPython, you can have it serving JSON data over your local network, then log it with a database and visualise it in a dashboard. Here I&rsquo;m just going to briefly describe my setup as the basis for later blog articles.
Overall setup Architecture diagram
Full-size image"><meta property="og:type" content="article"><meta property="og:url" content="/post/logging-ambient-data-raspberry-pico-grafana-pi/"><meta property="og:image" content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-11-22T12:49:48+01:00"><meta property="article:modified_time" content="2022-11-22T12:49:48+01:00"><meta property="og:site_name" content="John Heaven"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Part 0: Logging and visualising ambient data with a Raspberry Pico W"><meta name=twitter:description content="The Raspberry Pico W is a cheap microcontroller (around €8) that can control sensors and access a WIFI network. With a bit of soldering and MicroPython, you can have it serving JSON data over your local network, then log it with a database and visualise it in a dashboard. Here I&rsquo;m just going to briefly describe my setup as the basis for later blog articles.
Overall setup Architecture diagram
Full-size image"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"/post/"},{"@type":"ListItem","position":3,"name":"Part 0: Logging and visualising ambient data with a Raspberry Pico W","item":"/post/logging-ambient-data-raspberry-pico-grafana-pi/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Part 0: Logging and visualising ambient data with a Raspberry Pico W","name":"Part 0: Logging and visualising ambient data with a Raspberry Pico W","description":"The Raspberry Pico W is a cheap microcontroller (around €8) that can control sensors and access a WIFI network. With a bit of soldering and MicroPython, you can have it serving JSON data over your local network, then log it with a database and visualise it in a dashboard. Here I\u0026rsquo;m just going to briefly describe my setup as the basis for later blog articles.\nOverall setup Architecture diagram\nFull-size image","keywords":[],"articleBody":"The Raspberry Pico W is a cheap microcontroller (around €8) that can control sensors and access a WIFI network. With a bit of soldering and MicroPython, you can have it serving JSON data over your local network, then log it with a database and visualise it in a dashboard. Here I’m just going to briefly describe my setup as the basis for later blog articles.\nOverall setup Architecture diagram\nFull-size image\nThe graphic above shows the overall setup. We’ve got:\nOne or more Picos, with a sensor connected to each, A wifi connection from the Pico(s) to the router A Raspberry Pi The Pi runs Manjaro It has Docker installed The Ambient Data logger (a small Python application) runs inside a Docker container. It queries the Picos every 10 minutes and writes data to the Postgres DB The Postgres DB runs inside another Docker container, and this is where data is logged Yet another Docker container holds a Grafana installation, exposed on port 80 for access via the network. Grafana queries the Postgres DB regularly Anyone on the local network can log into Grafana (if they have an account) and see the visualised data The Pico W I soldered a sensor to each Pico W (A DHT-22 to one, and a BME280 to another) and wrote some MicroPython code to listen for requests over the network, take a reading, then respond to the request with JSON data.\nRaspberry Pi I’ve got a Raspberry Pi running Manjaro Linux, which has Docker installed. As described above, a custom-written script to log and store the data is in one container, a Postgres database in another, and a Grafana installation in another.\nI tried to keep the setup as modular as possible so that I can easily extend it and store the configuration in a Git repository. That way, if anything breaks I can recreate my setup relatively easily.\nThat’s it for now!\n","wordCount":"319","inLanguage":"en","datePublished":"2022-11-22T12:49:48+01:00","dateModified":"2022-11-22T12:49:48+01:00","author":{"@type":"Person","name":"John Heaven"},"mainEntityOfPage":{"@type":"WebPage","@id":"/post/logging-ambient-data-raspberry-pico-grafana-pi/"},"publisher":{"@type":"Organization","name":"John Heaven","logo":{"@type":"ImageObject","url":"%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="John Heaven (Alt + H)"><img src=/apple-touch-icon.png alt aria-label=logo height=35>John Heaven</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/about/ title=About><span>About</span></a></li><li><a href=/post/ title=Posts><span>Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/post/>Posts</a></div><h1 class=post-title>Part 0: Logging and visualising ambient data with a Raspberry Pico W</h1><div class=post-meta><span title='2022-11-22 12:49:48 +0100 CET'>November 22, 2022</span>&nbsp;·&nbsp;319 words&nbsp;·&nbsp;John Heaven</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overall-setup>Overall setup</a></li><li><a href=#the-pico-w>The Pico W</a></li><li><a href=#raspberry-pi>Raspberry Pi</a></li></ul></nav></div></details></div><div class=post-content><p>The Raspberry Pico W is a cheap microcontroller (around €8) that can control sensors and access a WIFI network. With a bit of soldering and MicroPython, you can have it serving JSON data over your local network, then log it with a database and visualise it in a dashboard. Here I&rsquo;m just going to briefly describe my setup as the basis for later blog articles.</p><h2 id=overall-setup>Overall setup<a hidden class=anchor aria-hidden=true href=#overall-setup>#</a></h2><p><figure><a href=media/ambient-data-arch.jpg><img loading=lazy src=/post/logging-ambient-data-raspberry-pico-grafana-pi/media/ambient-data-arch_hu7a5b5d5cc96d9ada230aeb87ed5b9159_73345_720x0_resize_q75_box.jpg alt="Architecture diagram"></a><figcaption><p>Architecture diagram</p></figcaption></figure><a href=media/ambient-data-arch.jpg>Full-size image</a></p><p>The graphic above shows the overall setup. We&rsquo;ve got:</p><ul><li>One or more Picos, with a sensor connected to each,</li><li>A wifi connection from the Pico(s) to the router</li><li>A Raspberry Pi<ul><li>The Pi runs Manjaro</li><li>It has Docker installed</li><li>The Ambient Data logger (a small Python application) runs inside a Docker container. It queries the Picos every 10 minutes and writes data to the Postgres DB</li><li>The Postgres DB runs inside another Docker container, and this is where data is logged</li><li>Yet another Docker container holds a Grafana installation, exposed on port 80 for access via the network. Grafana queries the Postgres DB regularly</li><li>Anyone on the local network can log into Grafana (if they have an account) and see the visualised data</li></ul></li></ul><h2 id=the-pico-w>The Pico W<a hidden class=anchor aria-hidden=true href=#the-pico-w>#</a></h2><p>I soldered a sensor to each Pico W (A DHT-22 to one, and a BME280 to another) and wrote some MicroPython code to listen for requests over the network, take a reading, then respond to the request with JSON data.</p><h2 id=raspberry-pi>Raspberry Pi<a hidden class=anchor aria-hidden=true href=#raspberry-pi>#</a></h2><p>I&rsquo;ve got a Raspberry Pi running Manjaro Linux, which has Docker installed. As described above, a custom-written script to log and store the data is in one container, a Postgres database in another, and a Grafana installation in another.</p><p>I tried to keep the setup as modular as possible so that I can easily extend it and store the configuration in a Git repository. That way, if anything breaks I can recreate my setup relatively easily.</p><p>That&rsquo;s it for now!</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=/post/ambient-data-api-with-raspberry-pico/><span class=title>« Prev</span><br><span>Part 1: Building an Ambient Data API With the Raspberry Pico W</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href>John Heaven</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>